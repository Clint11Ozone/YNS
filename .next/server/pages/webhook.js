"use strict";(()=>{var e={};e.id=567,e.ids=[567,660],e.modules={1323:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,o){return o in t?t[o]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,o)):"function"==typeof t&&"default"===o?t:void 0}}})},9722:(e,t,o)=>{o.r(t),o.d(t,{config:()=>h,default:()=>c,getServerSideProps:()=>f,getStaticPaths:()=>p,getStaticProps:()=>g,reportWebVitals:()=>m,routeModule:()=>S,unstable_getServerProps:()=>w,unstable_getServerSideProps:()=>v,unstable_getStaticParams:()=>P,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>b});var n=o(7093),s=o(5244),a=o(1323),i=o(1777),r=o.n(i),l=o(5863),u=o.n(l),d=o(2299);let c=(0,a.l)(d,"default"),g=(0,a.l)(d,"getStaticProps"),p=(0,a.l)(d,"getStaticPaths"),f=(0,a.l)(d,"getServerSideProps"),h=(0,a.l)(d,"config"),m=(0,a.l)(d,"reportWebVitals"),b=(0,a.l)(d,"unstable_getStaticProps"),y=(0,a.l)(d,"unstable_getStaticPaths"),P=(0,a.l)(d,"unstable_getStaticParams"),w=(0,a.l)(d,"unstable_getServerProps"),v=(0,a.l)(d,"unstable_getServerSideProps"),S=new n.PagesRouteModule({definition:{kind:s.x.PAGES,page:"/webhook",pathname:"/webhook",bundlePath:"",filename:""},components:{App:u(),Document:r()},userland:d})},5863:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return l}});let n=o(167),s=o(997),a=n._(o(6689)),i=o(6921);async function r(e){let{Component:t,ctx:o}=e;return{pageProps:await (0,i.loadGetInitialProps)(t,o)}}class l extends a.default.Component{render(){let{Component:e,pageProps:t}=this.props;return(0,s.jsx)(e,{...t})}}l.origGetInitialProps=r,l.getInitialProps=r,("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},4770:(e,t,o)=>{let n=o(2361);class s extends n{}let a=new s;e.exports=a},2285:e=>{let t={};e.exports={getConversationState:function(e){return t[e]||{stage:"start"}},setConversationState:function(e,o){t[e]=o}}},2299:(e,t,o)=>{let{sendMessage:n}=o(3516),s=o(4770);async function a(e){return 35>=Math.ceil((new Date(e).getTime()-Date.now())/864e5)}let i=[{name:"Amsterdam",budget:1800},{name:"Rotterdam",budget:1e3},{name:"Utrecht",budget:1e3},{name:"Den Haag",budget:1e3},{name:"Haarlem",budget:1800}];async function r(e,t){let o=e.body,r=o.data.fields;console.log(o);let l=r.find(e=>"First Name"===e.label)?.value;s.emit("firstName",l);let u=r.find(e=>"Phone"===e.label)?.value;s.emit("number",u);let d=r.find(e=>"Move-in date"===e.label)?.value;s.emit("date",d);let c=r.find(e=>"Please describe the composition of the household."===e.label)?.options.find(e=>e.id===r.find(e=>"Please describe the composition of the household."===e.label).value[0])?.text,g=r.find(e=>"Interior"===e.label)?.options.find(e=>e.id===r.find(e=>"Interior"===e.label).value[0])?.text,p=r.find(e=>"Budget"===e.label)?.value;s.emit("budget",p);let f=r.find(e=>"City"===e.label)?.options.find(e=>e.id===r.find(e=>"City"===e.label).value[0]),h=f?.text,m=i.find(e=>e.name===h)?.budget;if(console.log(`First Name: ${l}`),console.log(`Phone Number: ${u}`),console.log(`Budget: ${p}`),console.log(`City: ${h}`),console.log(`Move-in Date: ${d}`),console.log(`Household Composition: ${c}`),console.log(`Interior: ${g}`),console.log(`Chosen City: ${h}`),console.log(`City Budget: ${m}`),parseInt(p)>=parseInt(m)){if(await a(d)){let e=`Hi ${l}, we're excited to help you find your new home quickly. To get started, type 'start'.`;await n(u,e)}else{let e=`Hi ${l}, we canâ€™t wait to help you find your new home on ${d}. Donâ€™t worry, we will notify you by then. In the meantime, feel free to reach out if you have any questions.`;await n(u,e)}}else{let e=`Hi ${l}, we have received your registration on our website. Unfortunately, we cannot proceed with the budget you have provided. Considering the current housing market conditions and our no cure, no pay policy, we have had to establish a minimum budget requirement. Thank you for your understanding. If you would like to inquire about the minimum budgets, please respond with 'budget'.`;await n(u,e)}return t.status(200).send("Webhook received successfully"),l}e.exports={handleWebhook:r}},3516:(e,t,o)=>{let{Client:n,NoAuth:s}=o(55),a=o(1121),{getConversationState:i,setConversationState:r}=o(2285),l=o(4770),u=new n({authStrategy:new s});async function d(){return new Promise((e,t)=>{u.on("qr",o=>{a.toDataURL(o,(o,n)=>{o?t(o):e(n)})})})}async function c(e,t,o=""){try{let o=(e=e.replace("+",""))+"@c.us";await u.sendMessage(o,t),console.log(`Message sent to ${o}`)}catch(t){console.error(`Failed to send message to ${e}`,t)}}u.initialize(),u.on("ready",()=>{console.log("WhatsApp Client is ready!")});let g="";l.on("firstName",e=>{g=e}),l.on("budget",e=>{newBudget=e}),u.on("message",async e=>{if("start"===e.body.toLowerCase()){let t=e.from,o=g;r(t,{stage:"question1"}),setTimeout(()=>{u.sendMessage(t,`${o} To help you find your perfect home, we'd love to know more about what you like. This will help us tailor the search just for you:`)},3e3)}else{let t=e.from;switch(i(t).stage){case"question1":r(t,{stage:"question2"}),setTimeout(()=>{u.sendMessage(t,`ðŸ“Location: What's your ideal area or neighborhood?`)},3e3);break;case"question2":r(t,{stage:"question3"}),setTimeout(()=>{u.sendMessage(t,`ðŸ  What is your style: What style of home are you drawn to? (modern, traditional, loft)`)},3e3);break;case"question3":r(t,{stage:"question4"}),setTimeout(()=>{u.sendMessage(t,`ðŸ¤© Extras: What do your prefer (e.g., balcony, pet-friendly)`)},3e3);break;case"question4":r(t,{stage:"question5"}),setTimeout(()=>{u.sendMessage(t,`ðŸŽ‰ Congratulations! We're thrilled to help you find the perfect home. We'll be in touch with some listings soon.`)},3e3),setTimeout(()=>{u.sendMessage(t,`ðŸ“ˆ Speed up the process! Upload your documents now for priority assistance and get listings faster. https://upload.ynsagency.nl
  
  PS. Can't click the link? Just add us to contacts to activate it!

  âœ… Type 'done' after uploading.
  
  ðŸ˜• Prefer not to? Type 'listings'.`)},1e4);break;case"question5":let o=newBudget;r(t,{stage:"question6"}),setTimeout(()=>{u.sendMessage(t,`Shall we stick to listings within your budget of ${o} only? ðŸ˜Š 

Or open to exceeding it for the right match? Please reply with your max budget.`)},5e3)}}}),e.exports={sendMessage:c,generateQRCode:d}},5244:(e,t)=>{var o;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return o}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(o||(o={}))},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},1121:e=>{e.exports=require("qrcode")},6689:e=>{e.exports=require("react")},997:e=>{e.exports=require("react/jsx-runtime")},55:e=>{e.exports=require("whatsapp-web.js")},2361:e=>{e.exports=require("events")},1017:e=>{e.exports=require("path")}};var t=require("../webpack-runtime.js");t.C(e);var o=e=>t(t.s=e),n=t.X(0,[777],()=>o(9722));module.exports=n})();